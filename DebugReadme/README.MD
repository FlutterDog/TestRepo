

# Пояснительная записка (PCB + электрическая схема LCP) — FACTCHECK / скелет (Rev2)

> ✅ Принято: работаем по «короткому скелету» (узел → ключевые компоненты → инварианты → где смотреть → 1–3 вопроса максимум).
> Scope: **только плата + электрическая схема**. Без прошивки/протоколов/эксплуатации.

---

## 4. Электрическая схема по функциональным узлам (только “железо”)

---

## 4.1 Вход питания и защита

### 4.1.1 Ввод питания (+24V/0V) и разъём X2X/P3

**Назначение:** ввод питания 24V и шины RS-485 на одном клеммнике.

**Реализация (as-built):**

* P3: клеммник **EMSTBA 2.5/5-G-5.08** (5 контактов).
* Подтверждённый pinout: **+24V / +24V / NC / RS-485 A / RS-485 B**.

**Инварианты (не ломать без последствий):**

* Распиновка P3 и имена сетей питания/RS-485 должны сохраняться между ревизиями.
* PE/шасси в данной ревизии на плату не заведены (модель “2-проводное питание: +24V/0V”).

**Где смотреть:** `Plugs.SchDoc`, разъём **P3**.

⚠️ **Вопрос:** фиксируем про PE/шасси нейтрально “PE не заведён (as-built)”, или добавляем 1 строку мотивации “пластиковый корпус/двухпроводное питание”?

---

### 4.1.2 Первичная защита входа

**Назначение:** пережить типовые ошибки подключения/перегрузки в пределах разумных сценариев.

**Реализация (as-built по BOM):**

* F2: PPTC **MF-MSMF030-2** (30V, 0.30A hold) — входное предохранение.
* D1/D2: Schottky **B360A-13-F** (SMA) — защитные диоды в цепи входа/преобразователя.

**Инварианты:**

* Тип входного предохранения (PPTC) сохранять при совместимости по защите.
* Диоды сохранять по VRRM/IF/корпусу при заменах.

**Где смотреть:** `Power Supply.SchDoc` (входная часть), BOM: **F2, D1/D2**.

❗ **Ограничение:** сценарии вида “220VAC на вход 24V” в ПЗ не нормируются.

---

### 4.1.3 TVS по входу питания

**Назначение:** ограничение перенапряжений по VIN.

**As-built:** TVS на входе питания **не установлен** (Rev2).

**Инварианты:**

* Фиксируем как факт “не установлен”.

**Где смотреть:** `Power Supply.SchDoc`.

---

## 4.2 Стабилизаторы и домены напряжений

### 4.2.1 Карта доменов питания

**Назначение:** понять, какие напряжения где используются.

**As-built:**

* Основной преобразователь: **+24V → +5V** (buck).
* Далее: **+5V → +3V3** (LDO).
* Назначение доменов:

  * **+5V:** питание RS-485 трансиверов и части индикации.
  * **+3V3:** питание ATSAM3X8E, W5500 и 3.3V-логики.

**Инварианты:**

* Уровни **+5V** и **+3V3** и точки их формирования сохранять между ревизиями.

**Где смотреть:** `Power Supply.SchDoc`, шины `+5V`, `+3V3`.

---

### 4.2.2 Buck 24V → 5V

**Назначение:** получить +5V с входа 24V.

**As-built (ключевые компоненты):**

* U2: **TPS54331DR** (step-down).
* L5: **CDRH127/LDNP-220MC** (22 µH, 4.7A).
* D1/D2: **B360A-13-F** (Schottky) — по схеме.

**Инварианты:**

* Любые замены U2/L5/диодов/топологии силовой петли требуют валидации (пульсации/нагрев/старт).

**Где смотреть:** `Power Supply.SchDoc`, узел **U2**.

---

### 4.2.3 LDO 5V → 3.3V

**Назначение:** стабилизировать +3V3 для цифровой части.

**As-built:**

* U3: **LM1117MPX-3.3** (SOT-223).

**Инварианты:**

* Замена U3 — по критериям: 3.3V, ток, dropout, корпус/теплоотвод, устойчивость с применённой ёмкостью.

**Где смотреть:** `Power Supply.SchDoc`, узел **U3**.

---

### 4.2.4 Локальная фильтрация доменов

**Назначение:** локальная развязка питания около МК/ETH/разъёмов.

**As-built:** реализована типовой развязкой по листам узлов.

**Инварианты:**

* Не удалять локальные развязки около МК/ETH/разъёмов.
* При переносе компонентов на PCB сохранять принцип “развязка у ноги питания”.

**Где смотреть:** `Processor.SchDoc`, `Ethernet.SchDoc`, `Power Supply.SchDoc`.

---

## 4.3 МК и обвязка (только тактирование/reset/boot-линии как физика)

### 4.3.1 МК и питание доменов

**As-built:**

* U1: **ATSAM3X8EA-AU** (LFBGA-144), питание от **+3V3**.

**Инварианты:**

* Питание +3V3 и развязка/расположение критичных конденсаторов у ног питания сохраняются.

**Где смотреть:** `Processor.SchDoc`, **U1**.

---

### 4.3.2 Тактирование (основной + RTC)

**As-built:**

* Основной кварц МК: **12.0 MHz** (XTL6).
* RTC кварц: **32.768 kHz** (XT1).

**Инварианты:**

* Частоты кварцев сохранять 1:1; замены — по частоте/CL/корпусу.

**Где смотреть:** `Processor.SchDoc`, узлы **XTL6/XT1**.

---

### 4.3.3 Reset / сервисные линии

**As-built:**

* Линия **MASTER-RESET** реализована на листе процессора.
* P1: **MCD 1.5/6-G1-3.81** (6-pin) — сервисный/отладочный разъём (назначение по схеме).

**Инварианты:**

* Линии reset/erase/boot и их подтяжки сохранять по включению.
* Pinout P1 сохранять 1:1.

**Где смотреть:** `Processor.SchDoc`, `Plugs.SchDoc`, разъём **P1**.

⚠️ **Вопрос:** P1 считать строго **JTAG/SWD**, или “сервисный разъём смешанного назначения”? (чтобы корректно подписать в ПЗ одной строкой)

---

### 4.3.4 RTC backup от батарейки

**As-built:**

* B1: держатель **CR2032 1734178-1**.
* Backup-питание RTC реализовано через диодный узел на `Processor.SchDoc`.

**Инварианты:**

* Схему backup-питания не менять без проверки переключения/потребления.

**Где смотреть:** `Processor.SchDoc`, **B1**.

---

### 4.3.5 USB-физика (как часть обвязки)

**As-built:**

* J1: **USBB-1J** (USB-B).
* Z1/Z2: ESD **CG0603MLC-05E**.
* В линиях D+/D- стоят последовательные резисторы **39 Ω**.

**Инварианты:**

* ESD-защиту и последовательные резисторы D+/D- сохранять по месту/включению.

**Где смотреть:** `Processor.SchDoc`, **J1/Z1/Z2**.

---

## 5. PCB (короткий каркас)

### 5.1 Слои (as-built по gerber)

* Плата **6-слойная**: `Top (GTL) / GND (GP1) / Power (GP2) / HighSpeed (G1) / HighSpeed (G2) / Bottom (GBL)`.

### 5.2 Сверловка (as-built по NC drill)

* Плакированные отверстия: минимальный диаметр сверла в plated-файле **0.20 mm**.

⚠️ **Вопрос:** стек (толщина платы/медь/диэлектрики) — хотите фиксировать одной строкой (FR-4, X мм, медь Y oz) или оставить “см. stackup в проекте/zip”?

---

## 6. Элементная база и BOM-логика (только критичное)

### 6.1 Критичное “ядро” (совместимость/ремонт)

* U1 **ATSAM3X8E**
* U2 **TPS54331** (buck 24→5)
* U3 **LM1117-3.3** (LDO 5→3.3)
* U11/U16 **W5500** (Ethernet)
* U4–U10 **SN65HVD3082EDR** (RS-485)
* U18 **SC16IS752** (UART-bridge)
* ETH1/ETH2 **J0011D21BNL** (RJ45)
* SD1 **DM3AT-SF-PEJM5** (microSD)
* J1 **USBB-1J** (USB-B)

### 6.2 Правила замен (кратко)

* Для “ядра” — только **pin-to-pin** или замена по критериям: корпус, питание, температурный диапазон, класс интерфейса/скорость, ESD-защита.
* Пассивы (R/C/ферриты) — параметрические замены при сохранении номинала/корпуса/напряжения.

---

## Сжатый список вопросов (Rev2)

1. **PE/шасси формулировка:** только факт “PE не заведён (as-built)” или добавить 1 строку мотивации?
2. **P1 назначение:** строго JTAG/SWD или “сервисный смешанный”?
3. **Стек:** фиксировать одной строкой (FR-4, толщина X мм, медь Y oz) или ссылкой на stackup в проекте?
4. **Входное напряжение:** писать только “24VDC номинал” или добавить диапазон (если хотите) — либо оставить “не нормируется в ПЗ”.

---

## Где можно сказать “оставить как есть”

* Все расчётные/стандартные детали (пульсации, импедансы, длины, осциллограммы) — не включаем.
* Таблицы pin-to-pin по МК/ETH — не включаем, отсылаем к Altium-проекту.







# Пояснительная записка (PCB + электрическая схема LCP) — FACTCHECK / скелет (Rev2)

> Продолжение после разделов 4–6.
> Формат: узел → реализация → инварианты → где смотреть → вопросы.

---

## 7. Аппаратно-зависимые функции (только то, что про железо)

ℹ️ Scope раздела 7.*: **линии/цепи, которые влияют на загрузку/сброс/отладку**.
ℹ️ Не описываем логику прошивки, протоколы и сценарии.

---

### 7.1 Сброс, запуск, загрузочные состояния (boot/reset как цепи)

**Назначение:** обеспечить предсказуемый запуск МК, возможность аппаратного сброса и сервисного доступа.

**Реализация (as-built):**

* Линия **MASTER-RESET** реализована на листе процессора (цепь сброса МК).
* Сервисный разъём **P1** (6-pin) используется для отладки/сервиса (назначение выводов — по схеме).

**Инварианты:**

* Все линии reset/boot/erase (если они присутствуют на схеме) и их подтяжки сохранять по включению и номиналам.
* P1: pinout сохранять 1:1, если ожидается совместимость кабелей/оснастки.

**Где смотреть:** `Processor.SchDoc` (RESET/служебные линии), `Plugs.SchDoc` (P1).

⚠️ **Вопросы:**

1. P1 — строго **JTAG/SWD**, или «сервисный смешанный» (часть линий UART/Reset)? (1 строка для корректного описания).
2. На схеме есть ли отдельная линия **ERASE/BOOT** (например для ROM-boot) и выведена ли она на разъём/джампер? Если да — как обозначена (имя сети/RefDes подтяжки)?

---

### 7.2 Аппаратный сторожевой таймер / контроль зависаний (как железо)

**Назначение:** поддержка аппаратного WDG как функции МК и/или внешнего супервизора (если установлен).

**Реализация (as-built):**

* В рамках ATSAM3X8E доступен внутренний WDT; на уровне платы критично наличие корректного reset-цепи и питания.
* Внешний супервизор/таймер перезапуска: **уточнить по схеме**, установлен ли отдельный чип-супервизор или только пассивная RC-цепь/кнопка.

**Инварианты:**

* Если на плате есть внешний супервизор/WDG — его включение/порог/обвязку не менять без проверки поведения reset.

**Где смотреть:** `Processor.SchDoc` (цепи reset/supervisor).

⚠️ **Вопрос:** есть ли на плате отдельная микросхема супервизора reset (типа TLV803/STM706 и т.п.) или reset формируется только обвязкой/линией с отладочного интерфейса?

---

### 7.3 Аппаратные ограничения, влияющие на ПО (минимально)

**Назначение:** зафиксировать те параметры, которые «жёстко зашиты» в железе и определяют прошивку на уровне конфигурации пинов/частот.

**As-built (минимальный перечень):**

* Частоты кварцев: **12 MHz** (MCU), **32.768 kHz** (RTC), **25 MHz** (Ethernet-контроллер).
* Домены питания: +5V и +3V3 (см. 4.2).
* Наличие/тип внешних интерфейсных ИС (W5500, SN65HVD3082, SC16IS752) — определяет физические линии SPI/UART/EN.

**Инварианты:**

* Частоты кварцев и питание доменов сохранять между ревизиями.
* Замена ключевых ИС интерфейсов допускается только при pin-to-pin или контролируемой миграции.

**Где смотреть:** `Processor.SchDoc`, `Ethernet.SchDoc`, `Plugs.SchDoc`.

---

## 8. Интерфейсы (в этой ПЗ — только «карта разъёмов и физика»)

ℹ️ В 8.* фиксируем: разъёмы, уровни, защита, назначение линий, инварианты трассировки/ESD.

---

### 8.1 Карта разъёмов (кратко, только внешние интерфейсы платы)

#### 8.1.1 X2X / P3 — питание + RS-485 (шина модулей)

**As-built:** `+24V / +24V / NC / A / B`.

**Инварианты:** pinout и имена сетей сохранять.

**Где смотреть:** `Plugs.SchDoc`.

---

#### 8.1.2 Ethernet (W5500 + RJ45)

**Назначение:** физический интерфейс Ethernet через контроллер W5500 и разъём RJ45 (с интегр. магнитикой).

**Реализация (as-built, ключевое):**

* Ethernet-контроллер: **W5500** (на плате присутствуют минимум один, вероятно два экземпляра: U11/U16 — уточняется по схеме).
* Разъёмы: **ETH1/ETH2 = J0011D21BNL** (RJ45 MagJack).
* Тактирование W5500: кварц **25 MHz**.

**Инварианты:**

* Тип RJ45 MagJack и включение трансформатора/LED/Shield сохранять, если нужна совместимость по механике и EMI.
* Зона Ethernet на PCB: сохранять размещение защит/обвязки у разъёма (ESD/TVS, если стоят).

**Где смотреть:** `Ethernet.SchDoc`.

⚠️ **Вопросы (только если нужно зафиксировать):**

1. Shield RJ45 подключён к CHS GND напрямую, через RC/феррит или оставлен «плавающим»? (важно как факт).
2. Есть ли на линии Ethernet отдельные ESD-элементы (TVS arrays) и их RefDes/MPN?

---

#### 8.1.3 microSD (SPI)

**Назначение:** физическое подключение карты microSD для хранения конфигурации/данных (на уровне железа).

**Реализация (as-built):**

* Держатель: **SD1 DM3AT-SF-PEJM5**.
* Интерфейс: SPI-линии + сигнал детекта карты (если реализован на схеме).

**Инварианты:**

* Pinout SD1 и уровни (3.3V) сохранять.
* Защиту/серийные резисторы/подтяжки линий SD (если есть) сохранять по включению.

**Где смотреть:** `SD Holder.SchDoc`.

⚠️ **Вопрос:** есть ли на SD линиях ESD-защита и/или последовательные резисторы (RefDes), или линии идут напрямую?

---

#### 8.1.4 USB (USB-B)

**Назначение:** USB интерфейс на разъёме USB-B (физика подключения).

**Реализация (as-built):**

* Разъём: **J1 USBB-1J**.
* ESD: **Z1/Z2 CG0603MLC-05E**.
* D+/D-: последовательные резисторы **39 Ω**.

**Инварианты:**

* ESD и последовательные резисторы D+/D- сохранять по месту/включению.

**Где смотреть:** `Processor.SchDoc`.

---

#### 8.1.5 Сервис/отладка (P1)

**Назначение:** доступ к сервисным линиям (отладка/прошивка/сброс) на уровне железа.

**As-built:** P1 6-pin (см. схему — назначение выводов).

**Инварианты:** pinout P1 сохранять.

**Где смотреть:** `Plugs.SchDoc`, `Processor.SchDoc`.

---

### 8.2 RS-485 (физика линий)

**Назначение:** физический интерфейс RS-485 через отдельные трансиверы.

**Реализация (as-built, ключевое по BOM):**

* Трансиверы: **U4–U10 = SN65HVD3082EDR** (количество портов — уточняется по схеме, по BOM видно до 7 шт.).
* Питание трансиверов: **+5V**.

**Инварианты:**

* Питание +5V для трансиверов сохранять.
* Цепи защиты линий A/B (если установлены) и терминаторы (если есть) сохранять по включению.

**Где смотреть:** лист(ы) интерфейсов RS-485 (уточнить имя SchDoc в `Output rev2.pdf`), а также `Plugs.SchDoc` (выводы на разъёмы).

⚠️ **Вопросы:**

1. Есть ли на каждом порту **терминация/смещение** (bias) или это оставлено внешнему подключению? (фиксируем как факт).
2. Есть ли ESD/TVS на A/B линиях (RefDes/MPN), или защита ограничена самим трансивером?

---

### 8.3 UART-expander / дополнительные последовательные каналы (физика)

**Назначение:** расширение количества UART/COM через внешнюю ИС.

**Реализация (as-built):**

* U18: **SC16IS752** (UART bridge).

**Инварианты:**

* Тип ИС и интерфейс подключения (SPI/I2C — уточнить по схеме) сохранять.

**Где смотреть:** лист процессора/интерфейсов (RefDes U18 в `Output rev2.pdf`).

⚠️ **Вопрос:** U18 подключён к МК по SPI или по I²C (как факт в ПЗ одной строкой)?

---

## 9. Контроль и сервис (минимальный набор для платы)

---

### 9.1 Типовые проверки после сборки (минимум)

**Назначение:** базовая проверка правильности сборки и работоспособности доменов питания/интерфейсов на уровне железа.

**Минимальный набор (as-built):**

1. Проверка VIN на входе (после клеммника) и после предохранителя F2.
2. Проверка **+5V** (после buck) и **+3V3** (после LDO) на контрольных точках/у выходных конденсаторов.
3. Визуальная проверка ориентации диодов D1/D2 и полярных компонентов.
4. Проверка отсутствия перегрева U2/U3/L5 при номинальном VIN.
5. Проверка наличия активности интерфейсных узлов (по индикации/линку) — без требований к протоколам.

**Инварианты:**

* Набор контрольных точек лучше фиксировать в приложении (TPxx → что мерить).

**Где смотреть:** `Power Supply.SchDoc`, `Processor.SchDoc`, `Ethernet.SchDoc`.

⚠️ **Вопрос:** в проекте есть отдельный список testpoints (TPxx) или контрольные точки не выделялись? Если есть — добавим в приложение.

---

### 9.2 Диагностика по симптомам (короткая таблица)

**Назначение:** помочь инженеру быстро локализовать типовую аппаратную проблему.

| Симптом                      | Вероятная причина (железо)                      | Проверка                                                    |
| ---------------------------- | ----------------------------------------------- | ----------------------------------------------------------- |
| Нет запуска, нет индикации   | нет VIN / сработал F2 / ошибка ориентации D1/D2 | измерить VIN до/после F2; термоконтроль F2; визуально D1/D2 |
| VIN есть, +5V нет            | ошибка в узле U2/L5/D1/D2 или КЗ по +5V         | измерить на выходе U2; проверить нагрев U2/L5; прозвон +5V  |
| +5V есть, +3V3 нет           | неисправность U3 или КЗ по +3V3                 | измерить выход U3; термоконтроль U3; прозвон +3V3           |
| Ethernet линк не поднимается | проблема питания/кварца/разъёма/ESD цепей       | проверить +3V3 у W5500; наличие 25MHz; осмотр ETH разъёма   |
| RS-485 не работает на порту  | питание +5V на трансивере / защита/линия EN     | проверить +5V у Ux; проверить TXEN/DE/RE (по схеме)         |

**Где смотреть:** соответствующие SchDoc по узлам.

⚠️ Таблица будет точнее после того, как я подтвержу по схеме: где именно разнесены RS-485 порты и есть ли терминаторы/TVS.

---

### 9.3 Границы допустимых изменений (что можно менять без пересмотра)

**Можно менять (обычно):**

* Пассивы развязки при сохранении номинала/корпуса/напряжения.
* LED и их токоограничительные резисторы при сохранении тока и полярности.
* Разъёмы только при сохранении footprint/высоты/ключа (иначе — механическая несовместимость).

❗ **Требует обязательной валидации (железо):**

* Любые изменения узла питания (U2/U3/L5/D1/D2, силовая трассировка).
* Замены ключевых ИС ядра (U1, W5500, RS-485 трансиверы, SC16IS752).
* Изменения Ethernet-обвязки около RJ45 (Shield/ESD/магнитика).

---

## Сжатый список вопросов (для закрытия 7–9)

1. P1: строго JTAG/SWD или смешанный сервис?
2. Есть ли на схеме отдельная линия ERASE/BOOT и куда выведена?
3. Ethernet: Shield как подключён (CHS GND напрямую/через RC/феррит/не подключён)?
4. Ethernet: есть ли отдельные ESD/TVS по линиям (RefDes/MPN)?
5. SD: есть ли ESD/серийные резисторы/детект карты (как факт)?
6. RS-485: есть ли терминаторы/bias на плате или всё внешнее?
7. RS-485: есть ли TVS/ESD на A/B линиях?
8. U18 SC16IS752: подключение к МК по SPI или I²C?
9. Testpoints: есть ли TPxx отчёт/список, или точки не выделялись отдельно?



# Пояснительная записка (PCB + электрическая схема LCP) — FACTCHECK / скелет (Rev2)

> Продолжение после разделов 4–9.
> Парадигма: «как положено» (структурно, инженерно), но без раздувания и без переписывания даташитов.

---

## 10. Заключение

### 10.1 Итоговые ограничения и инварианты (сводный список)

**Цель раздела:** дать инженеру 1–2 страницы «что нельзя сломать» при сопровождении платы.

#### 10.1.1 Инварианты по питанию

* Номинальное питание платы: **24VDC** (ввод через P3).
  ⚠️ *Диапазон VIN в ПЗ фиксируем только если вы хотите его нормировать (иначе — «24V номинал»).*
* Домены питания:

  * **+5V** формируется buck (U2 TPS54331DR) и используется для RS-485 трансиверов и части индикации.
  * **+3V3** формируется LDO (U3 LM1117-3.3) и питает цифровую часть (ATSAM3X8E, W5500 и др.).
* Входная защита: **PPTC F2 (MF-MSMF030-2)** + защитные диоды (B360A-13-F) — топология и включение сохраняются.
* TVS по входу питания: **не установлен (as-built)**.

#### 10.1.2 Инварианты по тактированию

* МК: кварц **12 MHz** (XTL6).
* RTC: кварц **32.768 kHz** (XT1).
* Ethernet-контроллер: кварц **25 MHz** (по `Ethernet.SchDoc`).

#### 10.1.3 Инварианты по интерфейсам и разъёмам

* P3 (X2X): распиновка **+24V / +24V / NC / A / B** — сохранять 1:1.
* P1 (6-pin сервис): pinout сохранять 1:1 (назначение уточняется по схеме).
* RJ45 MagJack: тип/footprint и включение магнитики/Shield сохранять при необходимости механической и EMI-совместимости.
* USB-B: наличие ESD (CG0603MLC-05E) и последовательных резисторов D+/D- сохранять.
* microSD: тип держателя и уровни 3.3V сохранять; обвязку линий не менять без проверки.

#### 10.1.4 Инварианты по элементной базе («ядро»)

* МК: **ATSAM3X8E**.
* Питание: **TPS54331** (buck) + **LM1117-3.3** (LDO) + силовой дроссель (L5 22 µH).
* Ethernet: **W5500** (1–2 шт. по схеме), MagJack **J0011D21BNL**.
* RS-485: **SN65HVD3082EDR** (кол-во портов по схеме).
* UART bridge: **SC16IS752**.

#### 10.1.5 Инварианты по PCB (as-built)

* Слои: плата **6-слойная** (по gerber).
* Минимальная сверловка plated: **0.20 mm** (по NC drill).
* Требования по замене/правкам: изменения узлов питания, Ethernet-обвязки у разъёма, линий reset/boot — только после валидации.

⚠️ **Открытые точки для фиксации в этом разделе:**

* PE/Shield формулировка (нейтрально «PE не заведён» или +1 строка мотивации).
* Стек/толщина платы/медь (внести одной строкой или сослаться на stackup).

---

### 10.2 Риски при изменениях и минимальный план валидации после модификации

**Цель раздела:** зафиксировать «что проверять» после любых правок платы, чтобы снизить риск регресса.

#### 10.2.1 Классификация изменений (уровень риска)

**Класс A — низкий риск (обычно без повторной квалификации, но с базовой проверкой):**

* Замены пассивов развязки/подтяжек при сохранении номинала/корпуса/напряжения.
* Замены LED/резисторов индикации при сохранении тока и полярности.
* Исправления silk/маркировки без изменения меди.

**Класс B — средний риск (обязателен функциональный прогон питания + интерфейсов):**

* Замены разъёмов (при сохранении footprint) и их защитных элементов.
* Изменение обвязки SD/USB (серийные резисторы, ESD элементы, подтяжки).
* Изменения в цепях reset/boot (подтяжки, кнопки, RC).

**Класс C — высокий риск (нужна расширенная валидация и контроль осциллограмм/нагрева):**

* Любые изменения узла **buck 24→5** (U2/L5/диоды/конденсаторы, силовая трассировка).
* Изменения узла **LDO 5→3.3** (U3/теплоотвод/вых. ёмкости).
* Замены ключевых ИС «ядра» (ATSAM3X8E, W5500, SN65HVD3082, SC16IS752).
* Любые изменения в зоне Ethernet около RJ45 (Shield/магнитика/ESD/разводка пар).

#### 10.2.2 Минимальный план валидации (железо)

**1) Вход питания и защита**

* Проверка VIN на P3 (до/после F2) при 24V.
* Контроль отсутствия нагрева F2 в нормальном режиме.

**2) Домены питания**

* Измерить **+5V** (после buck) и **+3V3** (после LDO) без нагрузки и под нагрузкой платы.
* Контроль нагрева U2/L5/U3 при длительной работе.

**3) Тактирование**

* Подтверждение наличия генерации 12 MHz (МК), 25 MHz (Ethernet), 32.768 kHz (RTC) — достаточно «есть/нет» (без нормирования фазового шума).

**4) Интерфейсы (физика)**

* Ethernet: линк/активность на RJ45 (как физический признак), отсутствие перегрева/аномалий.
* RS-485: наличие питания трансиверов + базовая проверка линии (не протокол) — «есть передача/есть приём» на одном порту.
* USB: определяется хостом / активность линий (как физический признак).
* SD: детект карты и базовый обмен по SPI (как физика линий).

**5) DFM/DFT контроль**

* Сверка маркировок/полярностей ключевых компонентов.
* Проверка доступности контрольных точек/площадок (если выделены).

⚠️ **Открытый вопрос (для точности плана):** есть ли в проекте формальный перечень testpoints (TPxx), или контрольные точки подразумеваются по площадкам компонентов?

---

## Приложения (минимум «как положено», без раздувания)

> В приложениях держим «табличные факты» и «ссылки на файлы», чтобы основной текст не распух.

---

### Приложение A. Структурная схема (уровень платы)

**Содержимое:** 1 рисунок (блоки на плате и связи), без описания прошивки.

* Вход питания 24V → buck 5V → LDO 3.3V.
* ATSAM3X8E.
* Ethernet (W5500 → MagJack).
* RS-485 порты (трансиверы → разъёмы).
* microSD.
* USB.

**Источник:** `Output rev2.pdf` (или рисуется вручную по схеме).

---

### Приложение B. Дерево питания (power-tree)

**Содержимое:** 1 рисунок/таблица:

* VIN (24V) → +5V (U2) → +3V3 (U3).
* Потребители доменов (группами, без расписывания токов по каждому IC):

  * +5V: RS-485, индикация.
  * +3V3: MCU, Ethernet, SD и др.

⚠️ **Опционально:** добавить измеренные токи доменов, если у вас они есть (если нет — не нормируем).

---

### Приложение C. Таблица разъёмов (pinout)

**Содержимое:** короткая таблица только для внешних разъёмов платы.

Пример структуры таблицы:

* Разъём / Контакт / Имя сети / Назначение / Уровень / Примечание.

**Минимальный набор:**

* P3 (X2X): +24V/+24V/NC/A/B.
* P1 (сервис): pinout по схеме (после уточнения назначения).
* ETH1/ETH2: указать только «RJ45 MagJack, 10/100, интегр. магнитика» (без пинов трансформатора).
* SD1: microSD, питание 3.3V.
* J1: USB-B, ESD защита.

---

### Приложение D. Таблица напряжений и контрольных точек

**Содержимое:** список «что измерять» на плате.

* VIN (до/после F2).
* +5V.
* +3V3.
* (опционально) VBAT/RTC backup.

⚠️ **Вопрос:** есть ли в проекте TPxx? Если нет — в таблице фиксируем «точка измерения = вывод/конденсатор рядом с узлом».

---

### Приложение E. Состав производственного релиза (что отдаётся в производство)

**Содержимое:** перечень файлов и назначение:

* Gerber (слои меди/маски/шелкографии).
* NC drill.
* (Если есть) pick&place / assembly drawing.
* BOM (Bome Rev2.csv).
* PDF схем (Output rev2.pdf).

**Источник:** `Gerber + Stack r2.zip` + `Bome Rev2.csv` + `Output rev2.pdf`.

---

### Приложение F. История ревизий платы

**Содержимое:** таблица «Rev → дата/причина → ключевые изменения».

⚠️ **Вопрос:** какие ревизии реально существовали (Rev1/Rev2/…)? Если есть только Rev2 — фиксируем одну строку.

---

## Сводный список вопросов (для закрытия 10 + приложений)

1. Формулировка про PE/шасси: факт или +1 строка мотивации?
2. P1: назначение (JTAG/SWD или смешанный сервис) — как подписать.
3. Стек: хотите ли фиксировать одной строкой толщину/медь/материал (FR-4, X мм, Y oz) или ссылкой на stackup.
4. Testpoints: есть ли TPxx список/обозначения?
5. История ревизий: какие Rev были до Rev2 (если были) и 1–2 ключевых изменения.


















---



### Правило хранения данных (строгий регламент)

#### Библиотека компонента (SchLib / PcbLib)
| Тип компонента | Default Designator | Default Comment | Description | User Params (Mfr/MPN/…) | Footprint model |
|---|---:|---:|---:|---:|---:|
| Пассивки (R/C/L/простые диоды) | ✅ | ❌ | ❌ | ❌ | ✅ |
| Уникальные ИС/MCU | ✅ | ❌ | ❌ | ❌ | ✅ |
| Разъёмы/клеммы | ✅ | ❌ | ❌ | ❌ | ✅ |
| Питание/модули/реле | ✅ | ❌ | ❌ | ❌ | ✅ |

#### Данные в проекте (SchDoc)
| Тип компонента | Comment | Description | Manufacturer | Manufacturer Part Number | BOM Description |
|---|---:|---:|---:|---:|---:|
| Пассивки (R/C/L/простые диоды) | ✅ | ❌ | ✅ | ✅ | ✅ |
| Уникальные ИС/MCU | ❌ | ❌ | ✅ | ✅ | ✅ |
| Разъёмы/клеммы | ❌ | ❌ | ✅ | ✅ | ✅ |
| Питание/модули/реле | ❌ | ❌ | ✅ | ✅ | ✅ |



## Примеры заполнения (эталоны)

### Пример 1 — Резистор (пассивка)
#### Библиотека компонента (SchLib / PcbLib)
| Поле | Значение |
|---|---|
| Default Designator | `R?` |
| Default Comment | *(пусто)* |
| Description | *(пусто)* |
| User Params (Mfr/MPN/…) | *(пусто)* |
| Footprint model | `RES_0603` *(пример)* |

#### Данные в проекте (SchDoc)
| Поле | Значение |
|---|---|
| Designator | `R24` *(пример)* |
| Comment | `240R` *(пример)* |
| Description | *(пусто)* |
| Manufacturer | `Yageo` *(пример)* |
| Manufacturer Part Number | `RC0603FR-07240RL` *(пример)* |
| BOM Description | `Resistor 240R 1% 0.1W 0603` *(пример)* |

---

### Пример 2 — МК SAM3X8E (уникальная ИС)
#### Библиотека компонента (SchLib / PcbLib)
| Поле | Значение |
|---|---|
| Default Designator | `U?` |
| Default Comment | *(пусто)* |
| Description | *(пусто)* |
| User Params (Mfr/MPN/…) | *(пусто)* |
| Footprint model | `LQFP144_20x20_0.5mm` *(пример)* |

#### Данные в проекте (SchDoc)
| Поле | Значение |
|---|---|
| Designator | `U1` *(пример)* |
| Comment | *(пусто)* |
| Description | *(пусто)* |
| Manufacturer | `Microchip` *(пример)* |
| Manufacturer Part Number | `ATSAM3X8EA-AU` *(пример)* |
| BOM Description | `MCU ATSAM3X8E, ARM Cortex-M3, LQFP144` *(пример)* |
